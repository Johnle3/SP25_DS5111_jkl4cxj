# Makefile

# Default target: Display the contents of the Makefile
default:
    @cat Makefile

# Set up a Python virtual environment
env:
    python3 -m venv env
    . env/bin/activate && pip install --upgrade pip

# Update the virtual environment and install dependencies
update: env
    . env/bin/activate && pip install -r requirements.txt

# Scrape stock gainers data from Yahoo Finance and save to ygainers.html
ygainers.html:
    sudo google-chrome-stable --headless --disable-gpu --dump-dom --no-sandbox --timeout=5000 'https://finance.yahoo.com/markets/stocks/gainers/?start=0&count=200' > ygainers.html

# Parse ygainers.html and save the processed data to ygainers.csv
ygainers.csv: ygainers.html
    . env/bin/activate && python -c "import pandas as pd; raw = pd.read_html('ygainers.html'); raw[0].to_csv('ygainers.csv')"

# Scrape stock gainers data from Wall Street Journal and save to wjsgainers.html
wjsgainers.html:
    sudo google-chrome-stable --headless --disable-gpu --dump-dom --no-sandbox --timeout=500 'https://www.wsj.com/market-data/stocks/us/movers' > wjsgainers.html

# Parse wjsgainers.html and save the processed data to wjsgainers.csv
wjsgainers.csv: wjsgainers.html
    . env/bin/activate && python -c "import pandas as pd; raw = pd.read_html('wjsgainers.html'); raw[0].to_csv('wjsgainers.csv')"

# Clean up generated files
clean:
    rm -f ygainers.html ygainers.csv wjsgainers.html wjsgainers.csv
